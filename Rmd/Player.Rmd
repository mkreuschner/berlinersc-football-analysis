---
title: "Analysis"
output: html_document
---
<!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
<style>
div {
    margin: 20px auto;
    max-width: 500px;
    text-align: center;
}

select, button {
    margin: 10px 0;
    padding: 10px;
    font-size: 16px;
    width: 100%;
    max-width: 400px;
}

button {
    background-color: #007bff;
    color: white;
    border: none;
    cursor: pointer;
}

button:hover {
    background-color: #0056b3;
}

#result {
    margin-top: 20px;
    padding: 20px;
    background-color: #f9f9f9;
    color: #333;
    border-radius: 5px;
    text-align: left;
    max-width: 400px;
    margin: 20px auto;
}

</style>
<body>

<header>
  <button class="button"><span><a href="https://mkreuschner.github.io/berlinersc-football-analysis.github.io/">Back<a/> </span></button>
  <h1 id="Matchplan">Data Analyse</h1>
  <img src="https://www.berlinersc-fussball.de/__we_thumbs__/37837_17_LogoInBlock.png?m=1538584477" alt="Berliner SC" style="float:right;width:6rem;">
</header>

<div>
<select id="teamSelect" onchange="updatePlayerDropdown()">
<option value="">Wähle ein Team</option>
</select>
<br>
<select id="playerSelect">
<option value="">Wähle einen Spieler</option>
</select>
<br>
<button onclick="searchPlayer()">Suchen</button>
</div>
<br>
<div id="result">
</div>


```{R echo = FALSE, results='markup'}

```

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script>
const csvFilePath = 'https://raw.githubusercontent.com/mkreuschner/berlinersc-football-analysis.github.io/main/data/player_data.csv';
let playersData = [];

// CSV-Daten laden und parsen
Papa.parse(csvFilePath, {
    download: true,
    header: true,
    skipEmptyLines: true,
    complete: function(results) {
        if (results.errors.length) {
            console.error('Parsing-Fehler:', results.errors);
            alert('Fehler beim Laden der Daten. Bitte überprüfen Sie die Datei.');
        } else {
            playersData = results.data;
            console.log('Erfolgreich geladen:', playersData);
            populateTeamDropdown();
        }
    },
    error: function(err) {
        console.error('PapaParse-Fehler:', err);
        alert('Fehler beim Laden der CSV-Datei: ' + err.message);
    }
});

// Team-Dropdown mit Teams füllen
function populateTeamDropdown() {
    const teams = [...new Set(playersData.map(player => player.Team).filter(Boolean))]; // Einzigartige Teams
    const teamSelect = document.getElementById('teamSelect');
    teams.forEach(team => {
        const option = document.createElement('option');
        option.value = team;
        option.textContent = team;
        teamSelect.appendChild(option);
    });
}

// Spieler-Dropdown basierend auf ausgewähltem Team aktualisieren
function updatePlayerDropdown() {
    const selectedTeam = document.getElementById('teamSelect').value;
    const playerSelect = document.getElementById('playerSelect');
    playerSelect.innerHTML = '<option value="">Wähle einen Spieler</option>';
    if (selectedTeam) {
        const players = playersData.filter(player => player.Team === selectedTeam).map(player => player.Name);
        players.forEach(name => {
            const option = document.createElement('option');
            option.value = name;
            option.textContent = name;
            playerSelect.appendChild(option);
        });
    }
}

// Spieler suchen und Eigenschaften anzeigen
function searchPlayer() {
    const selectedPlayer = document.getElementById('playerSelect').value;
    const resultDiv = document.getElementById('result');
    resultDiv.innerHTML = ''; // Alte Ergebnisse löschen
    if (selectedPlayer) {
        const player = playersData.find(p => p.Name === selectedPlayer);
        if (player) {
            resultDiv.innerHTML = `
                <h3>${player.Name || "Nicht verfügbar"}</h3>
                <p>Team: ${player.Team || "Nicht verfügbar"}</p>
                <p>Nummer: ${player.Nummer || 0}</p>
                <p>Position: ${player.most_position || 0}</p>
                <p>Score: ${player.weighted_score || 0}</p>
                <p>Spiele: ${player.Spiele || 0}</p>
                <p>Spielzeit: ${player.Spielzeit || 0}</p>
                <p>Tore: ${player.Tore || 0}</p>
                <p>Assists: ${player.Assists || 0}</p>
            `;
        } else {
            resultDiv.innerHTML = '<p>Spieler nicht gefunden.</p>';
        }
    } else {
        resultDiv.innerHTML = '<p>Bitte wähle einen Spieler aus.</p>';
    }
}
</script>

<body>
